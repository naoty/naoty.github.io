{"data":{"site":{"siteMetadata":{"rootURL":"https://naoty.github.io"}},"markdownRemark":{"frontmatter":{"title":"JSONをASCIIテーブルで表示する","time":"2018-03-05T17:34:00+0900","description":"naoty/tableにJSONをASCIIテーブルに表示する機能を追加した","tags":null},"html":"<p>もともとTSV形式の文字列をASCIIやMarkdown形式のテーブルに変換するコマンドだった<a href=\"https://github.com/naoty/table\">naoty/table</a>を改善して、JSON形式の文字列を受け取れるようにした。</p>\n<p>例えば、以下のようなJSONファイルがあったとする。</p>\n<pre><code class=\"language-json\">// pokemons.json\n[\n  {\n    \"id\": 1,\n    \"name\": \"bulbasaur\"\n  },\n  {\n    \"id\": 2,\n    \"name\": \"ivysaur\"\n  },\n  {\n    \"id\": 3,\n    \"name\": \"venusaur\"\n  }\n]\n</code></pre>\n<p>このとき、以下のようにパイプで<code>table</code>コマンドに渡すとASCII形式に変換できる。</p>\n<pre><code class=\"language-shell\">$ cat pokemons.json | table -f json:ascii\n+----+-----------+\n| id | name      |\n+----+-----------+\n| 1  | bulbasaur |\n| 2  | ivysaur   |\n| 3  | venusaur  |\n+----+-----------+\n</code></pre>\n<p><code>table</code>コマンドは出力フォーマットとしてMarkdown形式のテーブルも選べるので、以下のように出力できる。</p>\n<pre><code class=\"language-shell\">$ cat pokemons.json | table -f json:markdown\n| id | name      |\n| -- | --------- |\n| 1  | bulbasaur |\n| 2  | ivysaur   |\n| 3  | venusaur  |\n</code></pre>\n<h1>モチベーション</h1>\n<p>最近、AWSの作業をすることが増えてAWS CLIから返ってくるJSONを扱うことが増えた。返ってきたJSONを<code>jq</code>コマンドで整形して表示するのだけど、件数が増えるとかなり見にくかった。そこで、このような機能を追加してASCIIテーブルとして見やすくしたかったので追加してみた。</p>\n<p>例えば、ECSのあるタスク定義に含まれるイメージを知りたいとき、こんな感じでやることになりそう。</p>\n<pre><code class=\"language-shell\">$ aws ecs describe-task-definition --task-definition hello_world:8 | \\\n  jq \".taskDefinition.containerDefinitions | map({name: .name, image: .image})\" | \\\n  table -f json:ascii\n+-----------+-----------+\n| name      | image     |\n+-----------+-----------+\n| wordpress | wordpress |\n| mysql     | mysql     |\n+-----------+-----------+\n</code></pre>","fileAbsolutePath":"/home/circleci/project/contents/posts/22.md"}},"pageContext":{"id":"f9a943d8-b86e-5fa5-b169-f2d9a77faf78"}}